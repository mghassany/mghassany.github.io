<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Lab | Analyse de données @ UCA</title>
<meta name="author" content="Mohamad Ghassany">
<meta name="description" content="You are free to apply this lab in or Python. The codes given in the lab and the main instructions are codes. It is up to you to adapt them if you use Python. If you use Python, verify that...">
<meta name="generator" content="bookdown 0.35 with bs4_book()">
<meta property="og:title" content="Lab | Analyse de données @ UCA">
<meta property="og:type" content="book">
<meta property="og:description" content="You are free to apply this lab in or Python. The codes given in the lab and the main instructions are codes. It is up to you to adapt them if you use Python. If you use Python, verify that...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Lab | Analyse de données @ UCA">
<meta name="twitter:description" content="You are free to apply this lab in or Python. The codes given in the lab and the main instructions are codes. It is up to you to adapt them if you use Python. If you use Python, verify that...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/font-awesome-5.1.0/css/all.css" rel="stylesheet">
<link href="libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Analyse de données @ UCA</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li class="book-part">Machine Learning II</li>
<li><a class="" href="discriminant-analysis.html"><span class="header-section-number">1</span> Discriminant Analysis</a></li>
<li><a class="active" href="lab.html">Lab</a></li>
<li><a class="" href="dimensionality-reduction.html"><span class="header-section-number">2</span> Dimensionality Reduction</a></li>
<li><a class="" href="lab-1.html">Lab</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="lab" class="section level1 unnumbered">
<h1>Lab<a class="anchor" aria-label="anchor" href="#lab"><i class="fas fa-link"></i></a>
</h1>
<div class="alert alert-block alert-warning">
<ul>
<li>You are free to apply this lab in <svg aria-hidden="true" role="img" viewbox="0 0 581 512" style="height:1em;width:1.13em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:steelblue;overflow:visible;position:relative;"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"></path></svg> or Python. The codes given in the lab and the main instructions are <svg aria-hidden="true" role="img" viewbox="0 0 581 512" style="height:1em;width:1.13em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:steelblue;overflow:visible;position:relative;"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"></path></svg> codes. It is up to you to adapt them if you use Python.</li>
<li>If you use Python, verify that <code>scikit-learn</code> is installed and verify its version (it should at least 0.21).</li>
<li>In <svg aria-hidden="true" role="img" viewbox="0 0 581 512" style="height:1em;width:1.13em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:steelblue;overflow:visible;position:relative;"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"></path></svg>, we are going to use the <code><a href="https://rdrr.io/pkg/MASS/man/lda.html">lda()</a></code> and <code><a href="https://rdrr.io/pkg/MASS/man/qda.html">qda()</a></code> functions from <code>MASS</code> library.</li>
<li>In Python, you can use :</li>
</ul>
<pre><code>from sklearn.discriminant_analysis import LinearDiscriminantAnalysis
from sklearn.discriminant_analysis import QuadraticDiscriminantAnalysis</code></pre>
</div>
<p>During this session we are going to analyse the <code>Social_Network_Ads</code> <a target="_blank" href="http://www.mghassany.com/MLcourse/datasets/Social_Network_Ads.csv">dataset <i class="fa fa-table" aria-hidden="true"></i></a>. This dataset contains informations of users of a social network and if they bought a specified product. We are going to model the variable <code>Purchased</code> in function of <code>Age</code> and <code>EstimatedSalary</code>. We will fit using the models Logistic Regression, LDA, QDA, and Naive Bayes.</p>
<!-- ## Report template {-} -->
<!-- For this week, use these YAML settings for your RMarkdown file: -->
<!-- ``` -->
<!-- --- -->
<!-- title: "Week 4" -->
<!-- subtitle: "Discriminant Analysis" -->
<!-- author: LastName FirstName -->
<!-- date: "`#r format(Sys.time())`" # remove the # to show the date -->
<!-- output: -->
<!--   html_document: -->
<!--     toc: true -->
<!--     toc_depth: 2 -->
<!--     toc_float: true -->
<!--     theme: cerulean -->
<!--     highlight: espresso -->
<!-- --- -->
<!-- ``` -->
<div id="logistic-regression" class="section level2 unnumbered">
<h2>Logistic Regression<a class="anchor" aria-label="anchor" href="#logistic-regression"><i class="fas fa-link"></i></a>
</h2>
<p><strong>1.</strong> First, let’s do the pre-processing steps and fit a <strong>logistic regression</strong> model. Please read and understand very well the following code (read the comments!). Then copy what is necessary for your report (but remove my comments!).</p>
<p>You can download the dataset from <a target="_blank" href="http://www.mghassany.com/MLcourseEfrei/datasets/Social_Network_Ads.csv">here <i class="fa fa-table" aria-hidden="true"></i></a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Loading the dataset.. I have putted it into a folder called "datasets"</span></span>
<span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">'http://www.mghassany.com/MLcourseEfrei/datasets/Social_Network_Ads.csv'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Describing and Exploring the dataset</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span> <span class="co"># to show the structure of the dataset. </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span> <span class="co"># will show some statistics of every column. </span></span>
<span><span class="co"># Remark what it shows when the column is a numerical or categorical variable.</span></span>
<span><span class="co"># Remark that it has no sense for the variable User.ID</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">Age</span> <span class="op">~</span> <span class="va">Purchased</span>, data<span class="op">=</span><span class="va">dataset</span>, col <span class="op">=</span> <span class="st">"blue"</span>, main<span class="op">=</span><span class="st">"Boxplot Age ~ Purchased"</span><span class="op">)</span></span>
<span><span class="co"># You know what is a boxplot right? I will let you interpret it.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">EstimatedSalary</span> <span class="op">~</span> <span class="va">Purchased</span>, data<span class="op">=</span><span class="va">dataset</span>,col <span class="op">=</span> <span class="st">"red"</span>,</span>
<span> main<span class="op">=</span><span class="st">"Boxplot EstimatedSalary ~ Purchased"</span><span class="op">)</span></span>
<span><span class="co"># Another boxplot</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">EstimatedSalary</span> <span class="op">~</span><span class="va">Purchased</span>, data<span class="op">=</span><span class="va">dataset</span><span class="op">)</span></span>
<span><span class="co"># Anova test, but we need to show the summary of </span></span>
<span><span class="co"># it in order to see the p-value and to interpret.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">EstimatedSalary</span> <span class="op">~</span><span class="va">Purchased</span>, data<span class="op">=</span><span class="va">dataset</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># What do you conclude ?</span></span>
<span><span class="co"># Now another anova test for the variable Age</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">Age</span> <span class="op">~</span><span class="va">Purchased</span>, data<span class="op">=</span><span class="va">dataset</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># There is a categorical variable in the dataset, which is Gender.</span></span>
<span><span class="co"># Of course we cannot show a boxplot of Gender and Purchased.</span></span>
<span><span class="co"># But we can show a table, or a mosaic plot, both tell the same thing.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">$</span><span class="va">Gender</span>,<span class="va">dataset</span><span class="op">$</span><span class="va">Purchased</span><span class="op">)</span></span>
<span><span class="co"># Remark for the function table(), that</span></span>
<span><span class="co"># in lines we have the first argument, and in columns we have the second argument.</span></span>
<span><span class="co"># Don't forget this when you use table() to show a confusion matrix!</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mosaicplot.html">mosaicplot</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Purchased</span> <span class="op">+</span> <span class="va">Gender</span>, data<span class="op">=</span><span class="va">dataset</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"MosaicPlot of two categorical variables: Puchased &amp; Gender"</span>,</span>
<span>  color <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># since these 2 variables are categorical, we can apply</span></span>
<span><span class="co"># a Chi-square test. The null hypothesis is the independance between</span></span>
<span><span class="co"># these variables. You will notice that p-value = 0.4562 which is higher than 0.05 (5%)</span></span>
<span><span class="co"># so we cannot reject the null hypothesis. </span></span>
<span><span class="co"># conclusion: there is no dependance between Gender and Purchased (who</span></span>
<span><span class="co"># said that women buy more than men? hah!)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">$</span><span class="va">Purchased</span>, <span class="va">dataset</span><span class="op">$</span><span class="va">Gender</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Let's say we want to remove the first two columns as we are not going to use them.</span></span>
<span><span class="co"># But, we can in fact use a categorical variable as a predictor in logistic regression.</span></span>
<span><span class="co"># It will treat it the same way as in regression. Check Appendix C.</span></span>
<span><span class="co"># Try it by yourself if you would like to.</span></span>
<span><span class="va">dataset</span> <span class="op">=</span> <span class="va">dataset</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span> <span class="co"># show the new structure of dataset</span></span>
<span></span>
<span></span>
<span><span class="co"># splitting the dataset into training and testing sets</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">caTools</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span> <span class="co"># CHANGE THE VALUE OF SEED. PUT YOUR STUDENT'S NUMBER INSTEAD OF 123.</span></span>
<span><span class="va">split</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/caTools/man/sample.split.html">sample.split</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">$</span><span class="va">Purchased</span>, SplitRatio <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span></span>
<span><span class="va">training_set</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">dataset</span>, <span class="va">split</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">test_set</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">dataset</span>, <span class="va">split</span> <span class="op">==</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># scaling</span></span>
<span><span class="co"># So here, we have two continuous predictors, Age and EstimatedSalary.</span></span>
<span><span class="co"># There is a very big difference in their scales (units).</span></span>
<span><span class="co"># That's why we scale them. But it is not always necessary.</span></span>
<span></span>
<span><span class="va">training_set</span><span class="op">[</span><span class="op">-</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">training_set</span><span class="op">[</span><span class="op">-</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="co">#only first two columns</span></span>
<span><span class="va">test_set</span><span class="op">[</span><span class="op">-</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">test_set</span><span class="op">[</span><span class="op">-</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Note that, we replace the columns of Age and EstimatedSalary in the training and</span></span>
<span><span class="co"># test sets but their scaled versions. I noticed in a lot of reports that you scaled</span></span>
<span><span class="co"># but you did not do the replacing.</span></span>
<span><span class="co"># Note too that if you do it column by column you will have a problem because </span></span>
<span><span class="co"># it will replace the column by a matrix, you need to retransform it to a vector then.</span></span>
<span><span class="co"># Last note, to call the columns Age and EstimatedSalary we can it like I did or </span></span>
<span><span class="co"># training_set[c(1,2)] or training_set[,c(1,2)] or training_set[,c("Age","EstimatedSalary")]</span></span>
<span></span>
<span></span>
<span><span class="co"># logistic regression</span></span>
<span></span>
<span><span class="va">classifier.logreg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">Purchased</span> <span class="op">~</span> <span class="va">Age</span> <span class="op">+</span> <span class="va">EstimatedSalary</span> , family <span class="op">=</span> <span class="va">binomial</span>, data<span class="op">=</span><span class="va">training_set</span><span class="op">)</span></span>
<span><span class="va">classifier.logreg</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">classifier.logreg</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># prediction</span></span>
<span><span class="va">pred.glm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">classifier.logreg</span>, newdata <span class="op">=</span> <span class="va">test_set</span><span class="op">[</span>,<span class="op">-</span><span class="fl">3</span><span class="op">]</span>, type<span class="op">=</span><span class="st">"response"</span><span class="op">)</span></span>
<span><span class="co"># Do not forget to put type response. </span></span>
<span><span class="co"># By the way, you know what you get when you do not put it, right?</span></span>
<span></span>
<span><span class="co"># Now let's assign observations to classes with respect to the probabilities</span></span>
<span><span class="va">pred.glm_0_1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">pred.glm</span> <span class="op">&gt;=</span> <span class="fl">0.5</span>, <span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="co"># I created a new vector, because we need the probabilities later for the ROC curve.</span></span>
<span></span>
<span><span class="co"># show some values of the vectors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">pred.glm</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">pred.glm_0_1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># confusion matrix</span></span>
<span><span class="va">cm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">test_set</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>, <span class="va">pred.glm_0_1</span><span class="op">)</span></span>
<span><span class="va">cm</span></span>
<span><span class="co"># First line to store it into cm, second line to show the matrix! </span></span>
<span></span>
<span><span class="co"># You remember my note about table() function and the order of the arguments?</span></span>
<span><span class="va">cm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">pred.glm_0_1</span>, <span class="va">test_set</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">cm</span></span>
<span></span>
<span><span class="co"># You can show the confusion matrix in a mosaic plot by the way</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mosaicplot.html">mosaicplot</a></span><span class="op">(</span><span class="va">cm</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># colors are random between 8 colors.</span></span>
<span></span>
<span><span class="co"># ROC</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="http://ipa-tys.github.io/ROCR/">ROCR</a></span><span class="op">)</span></span>
<span><span class="va">score</span> <span class="op">&lt;-</span> <span class="fu">prediction</span><span class="op">(</span><span class="va">pred.glm</span>,<span class="va">test_set</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="co"># we use the predicted probabilities not the 0 or 1</span></span>
<span><span class="fu">performance</span><span class="op">(</span><span class="va">score</span>,<span class="st">"auc"</span><span class="op">)</span> <span class="co"># y.values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu">performance</span><span class="op">(</span><span class="va">score</span>,<span class="st">"tpr"</span>,<span class="st">"fpr"</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"green"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,lty<span class="op">=</span><span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p>So now we have a logistic regression model stored in <code>classifier.logreg</code>. It is a model of <code>Purchased</code> in function of <code>Age</code> and <code>EstimatedSalary</code>.</p>
<!-- We will use this model to show the **decision boundary** in the next part of this PW. Then we will compare this model to other models obtained by Discriminant Analysis approaches. -->
<!-- 
## Decision Boundary of Logistic Regression {-}

Now you are going to visualize the decision boundary for logistic regression.

<div class="rmdinsight">
<ul>
<li>Since the decision boundary of logistic regression is a linear
(<em>you know why right?</em>) and the dimension of the feature space is
2 (<code>Age</code> and <code>EstimatedSalary</code>), the decision
boundary in this 2-dimensional space is a line that separates the
predicted classes “0” and “1” (values of the response
<code>Purchased</code>).</li>
<li>For logistic regression, we predict <span
class="math inline">\(y=1\)</span> if <span
class="math inline">\(\beta^T X \geq 0\)</span> (right side of the line)
and <span class="math inline">\(y=0\)</span> if <span
class="math inline">\(\beta^T X \lt 0\)</span> (left side of the line).
Where</li>
</ul>
[ =
<span class="math display">\[\begin{pmatrix} \beta_0 \\ \beta_1 \\
\beta2 \end{pmatrix}\]</span>
,, ,, X =
<span class="math display">\[\begin{pmatrix}
  1 \\
  X_1 \\
  X_2
  \end{pmatrix}\]</span>
<p>]</p>
<p>So we predict <span class="math inline">\(y=1\)</span> if <span
class="math inline">\(\beta_0 + \beta_1 X_1 + \beta_2 X_2 \geq
0\)</span> which means that the equation of the decision boundary (a
line here) is <span class="math inline">\(X_2 = -
\frac{\beta_1}{\beta_2}X_1 - \frac{\beta_0}{\beta_2}\)</span></p>
</div>

**2.** Plot the decision boundary obtained with logistic regression. In order to do so, calculate the intercept and the slope of the line presenting the decision boundary, then plot `EstimatedSalary` in function of `Age` (from the `test_set`) and add the line using `abline()`.



**3.** In order to verify that your line (decision boundary) is well plotted, color the points on the last Figure with respect to the predicted response.

**Hints**: 

* If your predictions are stored in `y_pred`, you can do it using `bg = ifelse(y_pred == 1, 'color1', 'color2')`, and precise the argument `pch` to be 21 (you can choose pch to be a value between 21 and 25, try it). 
* Then, add the line using `abline()`, put the line width = 2 to make it more visible. Do not forget to title the Figure).




**4.** Now make the same plot but color the points with respect to their real labels (the variable `Purchased`). From this figure, count the number of the false positive predictions and compare it to the value obtained in the confusion matrix.


 -->
</div>
<div id="linear-discriminant-analysis-lda" class="section level2 unnumbered">
<h2>Linear Discriminant Analysis (LDA)<a class="anchor" aria-label="anchor" href="#linear-discriminant-analysis-lda"><i class="fas fa-link"></i></a>
</h2>
<p>Let us apply linear discriminant analysis (LDA) now. First we will make use of the <code><a href="https://rdrr.io/pkg/MASS/man/lda.html">lda()</a></code> function in the package <code>MASS</code>. Second, you are going to create the model and predict the classes by yourself without using the <code><a href="https://rdrr.io/pkg/MASS/man/lda.html">lda()</a></code> function. And we will visualize the decision boundary of LDA.</p>
<p><strong>2.</strong> Fit a LDA model of <code>Purchased</code> in function of <code>Age</code> and <code>EstimatedSalary</code>. Name the model <code>classifier.lda</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span></span>
<span><span class="va">classifier.lda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/lda.html">lda</a></span><span class="op">(</span><span class="va">Purchased</span><span class="op">~</span><span class="va">Age</span><span class="op">+</span><span class="va">EstimatedSalary</span>, data<span class="op">=</span><span class="va">training_set</span><span class="op">)</span></span></code></pre></div>
<p><strong>3.</strong> Call <code>classifier.lda</code> and understand what does it compute.</p>
<p><strong>Plus:</strong> If you enter the following you will be returned with a list of summary information concerning the computation:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">classifier.lda</span><span class="op">$</span><span class="va">prior</span></span>
<span><span class="va">classifier.lda</span><span class="op">$</span><span class="va">means</span></span></code></pre></div>
<p><strong>4.</strong> On the test set, predict the probability of purchasing the product by the users using the model <code>classifier.lda</code>. Remark that when we predict using LDA, we obtain a list instead of a matrix, do <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> for your predictions to see what do you get.</p>
<p><strong>Remark</strong>: we get the predicted class here, without being obligated to round the predictions as we did for logistic regression.</p>
<p><strong>5.</strong> Compute the confusion matrix and compare the predictions results obtained by LDA to the ones obtained by logistic regression. What do you remark? (<strong>Hint</strong>: compare the accuracy)</p>
<p><strong>6.</strong> Now let us plot the decision boundary obtained with LDA. You saw in the course that decision boundary for LDA represent the set of values <span class="math inline">\(x\)</span> where <span class="math inline">\(\delta_k(x) = \delta_c(x)\)</span>. Recall that
<span class="math display">\[ \delta_k(X) = x^T \Sigma^{-1} \mu_k - \frac{1}{2} \mu_k^T \Sigma^{-1}  \mu_k + \log \pi_k \]</span></p>
<p>Here in our case, we have 2 classes (<span class="math inline">\(K=2\)</span>) and 2 predictors (<span class="math inline">\(p=2\)</span>). So the decision boundary (which is linear in the case of LDA, and line in our case since <span class="math inline">\(p=2\)</span>) will verify the equation <span class="math inline">\(\delta_0(x) = \delta_1(x)\)</span> Since we have two classes “0” and “1”. In the case of LDA this leads to linear boundary and is easy to be plotted. But in more complicated cases it is difficult to manually simplify the equations and plot the decision boundary. Anyway, there is a smart method to plot (but a little bit costy) the decision boundary in <code>R</code> using the function <code><a href="https://rdrr.io/r/graphics/contour.html">contour()</a></code>, the corresponding code is the following (you must adapt it and use it to plot your decision boundary):</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a grid corresponding to the scales of Age and EstimatedSalary</span></span>
<span><span class="co"># and fill this grid with lot of points</span></span>
<span><span class="va">X1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">training_set</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">training_set</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">X2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">training_set</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">training_set</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">grid_set</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">X2</span><span class="op">)</span></span>
<span><span class="co"># Adapt the variable names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">grid_set</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Age'</span>, <span class="st">'EstimatedSalary'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot 'Estimated Salary' ~ 'Age'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">test_set</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>     main <span class="op">=</span> <span class="st">'Decision Boundary LDA'</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">'Age'</span>, ylab <span class="op">=</span> <span class="st">'Estimated Salary'</span>,</span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">X1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">X2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># color the plotted points with their real label (class)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">test_set</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">21</span>, bg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">test_set</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span>, <span class="st">'green4'</span>, <span class="st">'red3'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make predictions on the points of the grid, this will take some time</span></span>
<span><span class="va">pred_grid</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">classifier.lda</span>, newdata <span class="op">=</span> <span class="va">grid_set</span><span class="op">)</span><span class="op">$</span><span class="va">class</span></span>
<span></span>
<span><span class="co"># Separate the predictions by a contour</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/contour.html">contour</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">X2</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">pred_grid</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">X1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">X2</span><span class="op">)</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="quadratic-discriminant-analysis-qda-1" class="section level2 unnumbered">
<h2>Quadratic Discriminant Analysis (QDA)<a class="anchor" aria-label="anchor" href="#quadratic-discriminant-analysis-qda-1"><i class="fas fa-link"></i></a>
</h2>
<p>Training and assessing a QDA model in <code>R</code> is very similar in syntax to training and assessing a LDA model. The only difference is in the function name <code><a href="https://rdrr.io/pkg/MASS/man/qda.html">qda()</a></code></p>
<p><strong>7.</strong> Fit a QDA model of <code>Purchased</code> in function of <code>Age</code> and <code>EstimatedSalary</code>. Name the model <code>classifier.qda</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># qda() is a function of library(MASS)</span></span>
<span><span class="va">classifier.qda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/qda.html">qda</a></span><span class="op">(</span><span class="va">Purchased</span><span class="op">~</span><span class="va">.</span>, data <span class="op">=</span> <span class="va">training_set</span><span class="op">)</span></span></code></pre></div>
<p><strong>8.</strong> Make predictions on the <code>test_set</code> using the QDA model <code>classifier.qda</code>. Show the confusion matrix and compare the results with the predictions obtained using the LDA model <code>classifier.lda</code>.</p>
<p><strong>9.</strong> Plot the decision boundary obtained with QDA. Color the points with the real labels.</p>
<!-- ## Naive Bayes {-} -->
<!-- If we assume that the features are independant in each class, we use a Naive Bayes classifier. Let us test it. -->
<!-- **14.** Fit a Naive Bayes model of `Purchased` in function of `Age` and `EstimatedSalary`. Name the model `classifier.naive`. Note that you can use the function `naiveBayes()` from package `e1071`. -->
<!-- ```{r eval=F, echo=T} -->
<!-- library(e1071) # install it if necessary -->
<!-- # (install it directly from the console) -->
<!-- classifier.naive <- naiveBayes(Purchased~., data=training_set) -->
<!-- # By the way, in these functions you can manually -->
<!-- # insert the features and the response, like this: -->
<!-- classifier.naive <- naiveBayes(x=training_set[-3],y=training_set$Purchased) -->
<!-- ``` -->
<!-- **15.** Make predictions on the `test_set` using `classifier.naive`. Show the computation matrix. Do you obtain better results than in LDA and QDA ? -->
<!-- ```{r eval=F, echo=F} -->
<!-- pred.naive = predict(classifier.naive, test_set[-3]) -->
<!-- cm.naive = table(pred.naive$class,test_set[,3]) -->
<!-- ``` -->
</div>
<div id="comparison" class="section level2 unnumbered">
<h2>Comparison<a class="anchor" aria-label="anchor" href="#comparison"><i class="fas fa-link"></i></a>
</h2>
<p><strong>10.</strong> In order to compare the methods we used, plot on the same Figure the ROC curve for each classifier we fitted and compare the correspondant AUC. What was the best model for this dataset? Can you justify it?</p>
<p><strong>Remark:</strong>
If you use the <code>ROCR</code> package:</p>
<ul>
<li>For Logistic regression, use the predicted probabilities in the <code>prediction()</code> (and not the round values “0” or “1”).</li>
<li>For LDA and QDA, put <code>pred.lda$posterior[,2]</code> in the <code>prediction()</code> function (those are the posterior probabilities that observations belong to class “1”).</li>
</ul>
</div>
<div id="lda-from-scratch" class="section level2 unnumbered">
<h2>LDA from scratch<a class="anchor" aria-label="anchor" href="#lda-from-scratch"><i class="fas fa-link"></i></a>
</h2>
<p><strong>11.</strong> Now let us build a LDA model for our data set without using the <code><a href="https://rdrr.io/pkg/MASS/man/lda.html">lda()</a></code> function. You are free to do it by creating a function or without creating one. Go back to question <strong>6</strong> and see what did you obtain by using <code><a href="https://rdrr.io/pkg/MASS/man/lda.html">lda()</a></code>. It computes the prior probability of group membership and the estimated group means for each of the two groups. Additional information that is not provided, but may be important, is the single covariance matrix that is being used for the various groupings.</p>
<div class="rmdtip">
<p>In LDA, we compute for every observation <span class="math inline">\(x\)</span> its discriminant score <span class="math inline">\(\delta_k(x)\)</span>. Then we attribute <span class="math inline">\(x\)</span> to the class that has the highest <span class="math inline">\(\delta\)</span>. Recall that</p>
<p><span class="math display">\[\delta_k(x) = x^T \Sigma^{-1} \mu_k - \frac{1}{2} \mu_k^T \Sigma^{-1}  \mu_k + \log \pi_k\]</span></p>
<p>So to compute <span class="math inline">\(\delta_k(x)\)</span> we need to estimate <span class="math inline">\(\pi_k\)</span>, <span class="math inline">\(\mu_k\)</span> and <span class="math inline">\(\Sigma\)</span>.</p>
<p>Note that <span class="math display">\[x=\begin{pmatrix}
            X_1 \\
            X_2
            \end{pmatrix}\]</span> and here <span class="math inline">\(X_1\)</span>=<code>Age</code> and <span class="math inline">\(X_2\)</span>=<code>EstimatedSalary</code>.</p>
</div>
<p>So let us do it step by step, first we will do the estimates:</p>
<p><strong>11.1</strong> Subset the training set into two sets: <code>class0</code> where <code>Purchased = 0</code> and <code>class1</code> where <code>Purchased = 1</code>).</p>
<p><strong>11.2</strong> Compute <span class="math inline">\(\pi_0\)</span> and <span class="math inline">\(\pi_1\)</span>.</p>
<p><span class="math display">\[\pi_i = N_i / N, \,\, \text{where} \,\, N_i \,\, \text{is the number of data points in group } i\]</span></p>
<p><strong>11.3</strong> Compute <span class="math inline">\(\mu_0\)</span> and <span class="math inline">\(\mu_1\)</span>.
<span class="math display">\[\mu_0 = \begin{pmatrix}
   \mu_0(X_1) \\
   \mu_0(X_2)
   \end{pmatrix} \,\, \text{and} \,\, \mu_1 = \begin{pmatrix}
   \mu_1(X_1) \\
   \mu_1(X_2)
   \end{pmatrix}\]</span></p>
<p>where, for example, <span class="math inline">\(\mu_0(X_1)\)</span> is the mean of the variable <span class="math inline">\(X_1\)</span> in the group <span class="math inline">\(0\)</span> (the subset <code>class0</code>).</p>
<p><strong>11.4</strong> Compute <span class="math inline">\(\Sigma\)</span>. In the case of two classes like here, it is computed by calculating the following:</p>
<p><span class="math display">\[\Sigma = \frac{(N_0-1)\Sigma_0 + (N_1-1)\Sigma_1}{N_0+N_1-2}\]</span></p>
<p>where <span class="math inline">\(\Sigma_i\)</span> is the estimated covariance matrix for specific group <span class="math inline">\(i\)</span>.</p>
<p><strong>Remark:</strong> Recall that in LDA we use the same <span class="math inline">\(\Sigma\)</span>. But in QDA we do not.</p>
<p><strong>11.5.</strong> Now that we have computed all the needed estimates, we can calculate <span class="math inline">\(\delta_0(x)\)</span> and <span class="math inline">\(\delta_1(x)\)</span> for any observation <span class="math inline">\(x\)</span>. And we will attribute <span class="math inline">\(x\)</span> to the class with the highest <span class="math inline">\(\delta\)</span>. First, try it for <span class="math inline">\(x\)</span> where <span class="math inline">\(x^T=(1,1.5)\)</span>, what is class prediction for this spesific <span class="math inline">\(x\)</span>?</p>
<p><strong>11.6.</strong> Compute the discriminant scores <span class="math inline">\(\delta\)</span> for the test set (a matrix <span class="math inline">\(100\times 2\)</span>), predict the classes and compare your results with the results obtained with the <code><a href="https://rdrr.io/pkg/MASS/man/lda.html">lda()</a></code> function.</p>
<p class="text-right">
◼
</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="discriminant-analysis.html"><span class="header-section-number">1</span> Discriminant Analysis</a></div>
<div class="next"><a href="dimensionality-reduction.html"><span class="header-section-number">2</span> Dimensionality Reduction</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#lab">Lab</a></li>
<li><a class="nav-link" href="#logistic-regression">Logistic Regression</a></li>
<li><a class="nav-link" href="#linear-discriminant-analysis-lda">Linear Discriminant Analysis (LDA)</a></li>
<li><a class="nav-link" href="#quadratic-discriminant-analysis-qda-1">Quadratic Discriminant Analysis (QDA)</a></li>
<li><a class="nav-link" href="#comparison">Comparison</a></li>
<li><a class="nav-link" href="#lda-from-scratch">LDA from scratch</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Analyse de données @ UCA</strong>" was written by Mohamad Ghassany. It was last built on 2024-03-19.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
