<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Machine Learning</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="Machine Learning course">
  <meta name="generator" content="bookdown 0.2 and GitBook 2.6.7">

  <meta property="og:title" content="Machine Learning" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Machine Learning course" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Machine Learning" />
  
  <meta name="twitter:description" content="Machine Learning course" />
  

<meta name="author" content="Mohamad Ghassany">


<meta name="date" content="2017-01-03">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="linear-regression.html">


<script src="book_assets/jquery-2.2.3/jquery.min.js"></script>
<link href="book_assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ESILV Intoduction to Machine Learning</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#what-is-machine-learning"><i class="fa fa-check"></i>What is Machine Learning ?</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#supervised-learning"><i class="fa fa-check"></i>Supervised Learning</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#unsupervised-learning"><i class="fa fa-check"></i>Unsupervised Learning</a></li>
</ul></li>
<li class="part"><span><b>Supervised Learning</b></span></li>
<li class="part"><span><b>Regression</b></span></li>
<li class="chapter" data-level="1" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>1</b> Linear Regression</a><ul>
<li class="chapter" data-level="1.1" data-path="linear-regression.html"><a href="linear-regression.html#notation"><i class="fa fa-check"></i><b>1.1</b> Notation</a></li>
<li class="chapter" data-level="1.2" data-path="linear-regression.html"><a href="linear-regression.html#model-representation"><i class="fa fa-check"></i><b>1.2</b> Model Representation</a></li>
<li class="chapter" data-level="1.3" data-path="linear-regression.html"><a href="linear-regression.html#why-estimate-f"><i class="fa fa-check"></i><b>1.3</b> Why Estimate <span class="math inline">\(f\)</span> ?</a><ul>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#prediction"><i class="fa fa-check"></i>Prediction</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#inference"><i class="fa fa-check"></i>Inference</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="linear-regression.html"><a href="linear-regression.html#simple-linear-regression-model"><i class="fa fa-check"></i><b>1.4</b> Simple Linear Regression Model</a></li>
<li class="chapter" data-level="1.5" data-path="linear-regression.html"><a href="linear-regression.html#estimating-the-coefficients"><i class="fa fa-check"></i><b>1.5</b> Estimating the Coefficients</a></li>
<li class="chapter" data-level="1.6" data-path="linear-regression.html"><a href="linear-regression.html#assessing-the-accuracy-of-the-coefficient-estimates"><i class="fa fa-check"></i><b>1.6</b> Assessing the Accuracy of the Coefficient Estimates</a><ul>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#hypothesis-testing"><i class="fa fa-check"></i>Hypothesis testing</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="linear-regression.html"><a href="linear-regression.html#anova-and-model-fit"><i class="fa fa-check"></i><b>1.7</b> ANOVA and model fit</a><ul>
<li class="chapter" data-level="1.7.1" data-path="linear-regression.html"><a href="linear-regression.html#anova"><i class="fa fa-check"></i><b>1.7.1</b> ANOVA</a></li>
<li class="chapter" data-level="1.7.2" data-path="linear-regression.html"><a href="linear-regression.html#the-r2-statistic"><i class="fa fa-check"></i><b>1.7.2</b> The <span class="math inline">\(R^2\)</span> Statistic</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="pw-1.html"><a href="pw-1.html"><i class="fa fa-check"></i>PW 1</a><ul>
<li class="chapter" data-level="1.8" data-path="pw-1.html"><a href="pw-1.html#some-r-basics"><i class="fa fa-check"></i><b>1.8</b> Some <code>R</code> basics</a><ul>
<li class="chapter" data-level="1.8.1" data-path="pw-1.html"><a href="pw-1.html#basic-commands"><i class="fa fa-check"></i><b>1.8.1</b> Basic Commands</a></li>
<li class="chapter" data-level="1.8.2" data-path="pw-1.html"><a href="pw-1.html#vectors"><i class="fa fa-check"></i><b>1.8.2</b> Vectors</a></li>
<li class="chapter" data-level="1.8.3" data-path="pw-1.html"><a href="pw-1.html#matrices-data-frames-and-lists"><i class="fa fa-check"></i><b>1.8.3</b> Matrices, data frames and lists</a></li>
<li class="chapter" data-level="1.8.4" data-path="pw-1.html"><a href="pw-1.html#graphics"><i class="fa fa-check"></i><b>1.8.4</b> Graphics</a></li>
<li class="chapter" data-level="1.8.5" data-path="pw-1.html"><a href="pw-1.html#distributions"><i class="fa fa-check"></i><b>1.8.5</b> Distributions</a></li>
<li class="chapter" data-level="1.8.6" data-path="pw-1.html"><a href="pw-1.html#working-directory"><i class="fa fa-check"></i><b>1.8.6</b> Working directory</a></li>
<li class="chapter" data-level="1.8.7" data-path="pw-1.html"><a href="pw-1.html#loading-data"><i class="fa fa-check"></i><b>1.8.7</b> Loading Data</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="pw-1.html"><a href="pw-1.html#regression"><i class="fa fa-check"></i><b>1.9</b> Regression</a><ul>
<li class="chapter" data-level="1.9.1" data-path="pw-1.html"><a href="pw-1.html#the-lm-function"><i class="fa fa-check"></i><b>1.9.1</b> The <code>lm</code> function</a></li>
<li class="chapter" data-level="1.9.2" data-path="pw-1.html"><a href="pw-1.html#predicting-house-value-boston-dataset"><i class="fa fa-check"></i><b>1.9.2</b> Predicting House Value: Boston dataset</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Machine Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pw-1" class="section level1 unnumbered">
<h1>PW 1</h1>
<div id="some-r-basics" class="section level2">
<h2><span class="header-section-number">1.8</span> Some <code>R</code> basics</h2>
<div id="basic-commands" class="section level3">
<h3><span class="header-section-number">1.8.1</span> Basic Commands</h3>
<p><code>R</code> uses functions to perform operations. To run a function called <code>funcname</code>,we type <code>funcname(input1, input2)</code> , where the inputs (or arguments) <code>input1</code> and <code>input2</code> tell <code>R</code> how to run the function. A function can have any number of inputs. For example, to create a vector of numbers, we use the function <code>c()</code> (for <em>concatenate</em>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">5</span>)
x
<span class="co">#ans&gt; [1] 1 3 2 5</span></code></pre></div>
<p>Note that the <code>&gt;</code> is not part of the command; rather, it is printed by <code>R</code> to indicate that it is ready for another command to be entered. We can also save things using <code>=</code> rather than <code>&lt;-</code>. Note that the answer in the code above is followed by <code>#ans&gt;</code> while in the <code>R</code> console it is not.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">2</span>)
x
<span class="co">#ans&gt; [1] 1 6 2</span>
y =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">3</span>)
<span class="kw">length</span>(x)
<span class="co">#ans&gt; [1] 3</span>
<span class="kw">length</span>(y)
<span class="co">#ans&gt; [1] 3</span>
x+y
<span class="co">#ans&gt; [1]  2 10  5</span></code></pre></div>
<p>Hitting the <em>up arrow</em> multiple times will display the previous commands, which can then be edited. This is useful since one often wishes to repeat a similar command.</p>
<p>The <code>ls()</code> function allows us to look at a list of all of the objects, such <code>ls()</code> as data and functions, that we have saved so far. The <code>rm()</code> function can be used to delete any object that we don’t want.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ls</span>()
<span class="co">#ans&gt; [1] &quot;A&quot;      &quot;Auto&quot;   &quot;B&quot;      &quot;myDf&quot;   &quot;myList&quot; &quot;vec&quot;    &quot;x&quot;      &quot;y&quot;</span>
<span class="kw">rm</span>(x)
<span class="kw">ls</span>()
<span class="co">#ans&gt; [1] &quot;A&quot;      &quot;Auto&quot;   &quot;B&quot;      &quot;myDf&quot;   &quot;myList&quot; &quot;vec&quot;    &quot;y&quot;</span></code></pre></div>
</div>
<div id="vectors" class="section level3">
<h3><span class="header-section-number">1.8.2</span> Vectors</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># A handy way of creating sequences is the operator :</span>
<span class="co"># Sequence from 1 to 5</span>
<span class="dv">1</span>:<span class="dv">5</span>
<span class="co">#ans&gt; [1] 1 2 3 4 5</span>

<span class="co"># Storing some vectors</span>
vec &lt;-<span class="st"> </span><span class="kw">c</span>(-<span class="fl">4.12</span>, <span class="dv">0</span>, <span class="fl">1.1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>)
vec
<span class="co">#ans&gt; [1] -4.12  0.00  1.10  1.00  3.00  4.00</span>

<span class="co"># Entry-wise operations</span>
vec +<span class="st"> </span><span class="dv">1</span>
<span class="co">#ans&gt; [1] -3.12  1.00  2.10  2.00  4.00  5.00</span>
vec^<span class="dv">2</span>
<span class="co">#ans&gt; [1] 16.97  0.00  1.21  1.00  9.00 16.00</span>

<span class="co"># If you want to access a position of a vector, use [position]</span>
vec[<span class="dv">6</span>]
<span class="co">#ans&gt; [1] 4</span>

<span class="co"># You also can change elements</span>
vec[<span class="dv">2</span>] &lt;-<span class="st"> </span>-<span class="dv">1</span>
vec
<span class="co">#ans&gt; [1] -4.12 -1.00  1.10  1.00  3.00  4.00</span>

<span class="co"># If you want to access all the elements except a position, use [-position]</span>
vec[-<span class="dv">2</span>]
<span class="co">#ans&gt; [1] -4.12  1.10  1.00  3.00  4.00</span>

<span class="co"># Also with vectors as indexes</span>
vec[<span class="dv">1</span>:<span class="dv">2</span>]
<span class="co">#ans&gt; [1] -4.12 -1.00</span>

<span class="co"># And also</span>
vec[-<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)]
<span class="co">#ans&gt; [1] 1.1 1.0 3.0 4.0</span></code></pre></div>
<div class="rmdexercise">
<p>
Do the following:
</p>
<ul>
<li>
Create the vector <span class="math inline"><em>x</em> = (1, 7, 3, 4)</span>.
</li>
<li>
Create the vector <span class="math inline"><em>y</em> = (100, 99, 98, …, 2, 1)</span>.
</li>
<li>
Compute <span class="math inline"><em>x</em><sub>2</sub> + <em>y</em><sub>4</sub></span> and <span class="math inline">cos(<em>x</em><sub>3</sub>)+sin(<em>x</em><sub>2</sub>)<em>e</em><sup>−<em>y</em><sub>2</sub></sup></span>. (Answers: <code>104</code>, <code>-0.9899925</code>)
</li>
<li>
Set <span class="math inline"><em>x</em><sub>2</sub> = 0</span> and <span class="math inline"><em>y</em><sub>2</sub> = −1</span>. Recompute the previous expressions. (Answers: <code>97</code>, <code>2.785875</code>)
</li>
<li>
Index <span class="math inline"><em>y</em></span> by <span class="math inline"><em>x</em> + 1</span> and store it as <code>z</code>. What is the output? (Answer: <code>z</code> is <code>c(-1, 100, 97, 96)</code>)
</li>
</ul>
</div>
</div>
<div id="matrices-data-frames-and-lists" class="section level3">
<h3><span class="header-section-number">1.8.3</span> Matrices, data frames and lists</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># A matrix is an array of vectors</span>
A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>:<span class="dv">4</span>, <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)
A
<span class="co">#ans&gt;      [,1] [,2]</span>
<span class="co">#ans&gt; [1,]    1    3</span>
<span class="co">#ans&gt; [2,]    2    4</span>

<span class="co"># Another matrix</span>
B &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>:<span class="dv">4</span>, <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
B
<span class="co">#ans&gt;      [,1] [,2]</span>
<span class="co">#ans&gt; [1,]    1    2</span>
<span class="co">#ans&gt; [2,]    3    4</span>

<span class="co"># Binding by rows or columns</span>
<span class="kw">rbind</span>(<span class="dv">1</span>:<span class="dv">3</span>, <span class="dv">4</span>:<span class="dv">6</span>)
<span class="co">#ans&gt;      [,1] [,2] [,3]</span>
<span class="co">#ans&gt; [1,]    1    2    3</span>
<span class="co">#ans&gt; [2,]    4    5    6</span>
<span class="kw">cbind</span>(<span class="dv">1</span>:<span class="dv">3</span>, <span class="dv">4</span>:<span class="dv">6</span>)
<span class="co">#ans&gt;      [,1] [,2]</span>
<span class="co">#ans&gt; [1,]    1    4</span>
<span class="co">#ans&gt; [2,]    2    5</span>
<span class="co">#ans&gt; [3,]    3    6</span>

<span class="co"># Entry-wise operations</span>
A +<span class="st"> </span><span class="dv">1</span>
<span class="co">#ans&gt;      [,1] [,2]</span>
<span class="co">#ans&gt; [1,]    2    4</span>
<span class="co">#ans&gt; [2,]    3    5</span>
A *<span class="st"> </span>B
<span class="co">#ans&gt;      [,1] [,2]</span>
<span class="co">#ans&gt; [1,]    1    6</span>
<span class="co">#ans&gt; [2,]    6   16</span>

<span class="co"># Accessing elements</span>
A[<span class="dv">2</span>, <span class="dv">1</span>] <span class="co"># Element (2, 1)</span>
<span class="co">#ans&gt; [1] 2</span>
A[<span class="dv">1</span>, ] <span class="co"># First row</span>
<span class="co">#ans&gt; [1] 1 3</span>
A[, <span class="dv">2</span>] <span class="co"># First column</span>
<span class="co">#ans&gt; [1] 3 4</span>

<span class="co"># A data frame is a matrix with column names</span>
<span class="co"># Useful when you have multiple variables</span>
myDf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">var1 =</span> <span class="dv">1</span>:<span class="dv">2</span>, <span class="dt">var2 =</span> <span class="dv">3</span>:<span class="dv">4</span>)
myDf
<span class="co">#ans&gt;   var1 var2</span>
<span class="co">#ans&gt; 1    1    3</span>
<span class="co">#ans&gt; 2    2    4</span>

<span class="co"># You can change names</span>
<span class="kw">names</span>(myDf) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;newname1&quot;</span>, <span class="st">&quot;newname2&quot;</span>)
myDf
<span class="co">#ans&gt;   newname1 newname2</span>
<span class="co">#ans&gt; 1        1        3</span>
<span class="co">#ans&gt; 2        2        4</span>

<span class="co"># The nice thing is that you can access variables by its name with the $ operator</span>
myDf$newname1
<span class="co">#ans&gt; [1] 1 2</span>

<span class="co"># And create new variables also (it has to be of the same</span>
<span class="co"># length as the rest of variables)</span>
myDf$myNewVariable &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)
myDf
<span class="co">#ans&gt;   newname1 newname2 myNewVariable</span>
<span class="co">#ans&gt; 1        1        3             0</span>
<span class="co">#ans&gt; 2        2        4             1</span>

<span class="co"># A list is a collection of arbitrary variables</span>
myList &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">vec =</span> vec, <span class="dt">A =</span> A, <span class="dt">myDf =</span> myDf)

<span class="co"># Access elements by names</span>
myList$vec
<span class="co">#ans&gt; [1] -4.12 -1.00  1.10  1.00  3.00  4.00</span>
myList$A
<span class="co">#ans&gt;      [,1] [,2]</span>
<span class="co">#ans&gt; [1,]    1    3</span>
<span class="co">#ans&gt; [2,]    2    4</span>
myList$myDf
<span class="co">#ans&gt;   newname1 newname2 myNewVariable</span>
<span class="co">#ans&gt; 1        1        3             0</span>
<span class="co">#ans&gt; 2        2        4             1</span>

<span class="co"># Reveal the structure of an object</span>
<span class="kw">str</span>(myList)
<span class="co">#ans&gt; List of 3</span>
<span class="co">#ans&gt;  $ vec : num [1:6] -4.12 -1 1.1 1 3 4</span>
<span class="co">#ans&gt;  $ A   : int [1:2, 1:2] 1 2 3 4</span>
<span class="co">#ans&gt;  $ myDf:&#39;data.frame&#39;: 2 obs. of  3 variables:</span>
<span class="co">#ans&gt;   ..$ newname1     : int [1:2] 1 2</span>
<span class="co">#ans&gt;   ..$ newname2     : int [1:2] 3 4</span>
<span class="co">#ans&gt;   ..$ myNewVariable: num [1:2] 0 1</span>
<span class="kw">str</span>(myDf)
<span class="co">#ans&gt; &#39;data.frame&#39;: 2 obs. of  3 variables:</span>
<span class="co">#ans&gt;  $ newname1     : int  1 2</span>
<span class="co">#ans&gt;  $ newname2     : int  3 4</span>
<span class="co">#ans&gt;  $ myNewVariable: num  0 1</span>

<span class="co"># A less lengthy output</span>
<span class="kw">names</span>(myList)
<span class="co">#ans&gt; [1] &quot;vec&quot;  &quot;A&quot;    &quot;myDf&quot;</span></code></pre></div>
</div>
<div id="graphics" class="section level3">
<h3><span class="header-section-number">1.8.4</span> Graphics</h3>
<p>The <code>plot()</code> function is the primary way to plot data in <code>R</code> . For instance, <code>plot(x,y)</code> produces a scatterplot of the numbers in <code>x</code> versus the numbers in <code>y</code>. There are many additional options that can be passed in to the <code>plot()</code> function. For example, passing in the argument <code>xlab</code> will result in a label on the <code>x-axis</code>. To find out more information about the <code>plot()</code> function, type <code>?plot</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x=<span class="kw">rnorm</span>(<span class="dv">100</span>)
<span class="co"># The rnorm() function generates a vector of random normal variables,</span>
<span class="co"># rnorm() with first argument n the sample size. Each time we call this</span>
<span class="co"># function, we will get a different answer.</span>
y=<span class="kw">rnorm</span>(<span class="dv">100</span>)
<span class="kw">plot</span>(x,y)</code></pre></div>
<p><img src="Machine-Learning_files/figure-html/unnamed-chunk-15-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># with titles</span>
<span class="kw">plot</span>(x,y,<span class="dt">xlab=</span><span class="st">&quot;this is the x-axis&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;this is the y-axis&quot;</span>,
<span class="dt">main=</span><span class="st">&quot;Plot of X vs Y&quot;</span>)</code></pre></div>
<p><img src="Machine-Learning_files/figure-html/unnamed-chunk-15-2.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="distributions" class="section level3">
<h3><span class="header-section-number">1.8.5</span> Distributions</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># R allows to sample [r], compute density/probability mass [d],</span>
<span class="co"># compute distribution function [p] and compute quantiles [q] for several</span>
<span class="co"># continuous and discrete distributions. The format employed is [rdpq]name,</span>
<span class="co"># where name stands for:</span>
<span class="co"># - norm -&gt; Normal</span>
<span class="co"># - unif -&gt; Uniform</span>
<span class="co"># - exp -&gt; Exponential</span>
<span class="co"># - t -&gt; Student&#39;s t</span>
<span class="co"># - f -&gt; Snedecor&#39;s F</span>
<span class="co"># - chisq -&gt; Chi squared</span>
<span class="co"># - pois -&gt; Poisson</span>
<span class="co"># - binom -&gt; Binomial</span>
<span class="co"># More distributions: ?Distributions</span>


<span class="co"># Sampling from a Normal - 100 random points from a N(0, 1)</span>
<span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)
<span class="co">#ans&gt;  [1]  0.5736  0.3045  1.7334  0.2014  0.5361 -0.1962 -1.2721 -1.9645</span>
<span class="co">#ans&gt;  [9]  0.0869 -0.7063</span>

<span class="co"># If you want to have always the same result, set the seed of the random number</span>
<span class="co"># generator</span>
<span class="kw">set.seed</span>(<span class="dv">45678</span>)
<span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)
<span class="co">#ans&gt;  [1]  1.440 -0.720  0.671 -0.422  0.378 -1.667 -0.508  0.443 -1.799 -0.618</span>

<span class="co"># Plotting the density of a N(0, 1) - the Gauss bell</span>
x &lt;-<span class="st"> </span><span class="kw">seq</span>(-<span class="dv">4</span>, <span class="dv">4</span>, <span class="dt">l =</span> <span class="dv">100</span>)
y &lt;-<span class="st"> </span><span class="kw">dnorm</span>(<span class="dt">x =</span> x, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)
<span class="kw">plot</span>(x, y, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</code></pre></div>
<p><img src="Machine-Learning_files/figure-html/unnamed-chunk-16-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Plotting the distribution function of a N(0, 1)</span>
x &lt;-<span class="st"> </span><span class="kw">seq</span>(-<span class="dv">4</span>, <span class="dv">4</span>, <span class="dt">l =</span> <span class="dv">100</span>)
y &lt;-<span class="st"> </span><span class="kw">pnorm</span>(<span class="dt">q =</span> x, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)
<span class="kw">plot</span>(x, y, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">main=</span><span class="st">&quot;The distribution function of a N(0, 1)&quot;</span>)</code></pre></div>
<p><img src="Machine-Learning_files/figure-html/unnamed-chunk-16-2.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Computing the 95% quantile for a N(0, 1)</span>
<span class="kw">qnorm</span>(<span class="dt">p =</span> <span class="fl">0.95</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)
<span class="co">#ans&gt; [1] 1.64</span>

<span class="co"># All distributions have the same syntax: rname(n,...), dname(x,...), dname(p,...)  </span>
<span class="co"># and qname(p,...), but the parameters in ... change. Look them in ?Distributions</span>
<span class="co"># For example, here is que same for the uniform distribution</span>

<span class="co"># Sampling from a U(0, 1)</span>
<span class="kw">set.seed</span>(<span class="dv">45678</span>)
<span class="kw">runif</span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1</span>)
<span class="co">#ans&gt;  [1] 0.9251 0.3340 0.2359 0.3366 0.7489 0.9327 0.3365 0.2246 0.6474 0.0808</span>

<span class="co"># Plotting the density of a U(0, 1)</span>
x &lt;-<span class="st"> </span><span class="kw">seq</span>(-<span class="dv">2</span>, <span class="dv">2</span>, <span class="dt">l =</span> <span class="dv">100</span>)
y &lt;-<span class="st"> </span><span class="kw">dunif</span>(<span class="dt">x =</span> x, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1</span>)
<span class="kw">plot</span>(x, y, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</code></pre></div>
<p><img src="Machine-Learning_files/figure-html/unnamed-chunk-16-3.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Computing the 95% quantile for a U(0, 1)</span>
<span class="kw">qunif</span>(<span class="dt">p =</span> <span class="fl">0.95</span>, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1</span>)
<span class="co">#ans&gt; [1] 0.95</span></code></pre></div>
<div class="rmdexercise">
<p>
Do the following:
</p>
<ul>
<li>
Compute the 90%, 95% and 99% quantiles of a <span class="math inline"><em>F</em></span> distribution with <code>df1 = 1</code> and <code>df2 = 5</code>. (Answer: <code>c(4.060420, 6.607891, 16.258177)</code>)
</li>
<li>
Sample 100 points from a Poisson with <code>lambda = 5</code>.
</li>
<li>
Plot the density of a <span class="math inline"><em>t</em></span> distribution with <code>df = 1</code> (use a sequence spanning from <code>-4</code> to <code>4</code>). Add lines of different colors with the densities for <code>df = 5</code>, <code>df = 10</code>, <code>df = 50</code> and <code>df = 100</code>.
</li>
</ul>
</div>
</div>
<div id="working-directory" class="section level3">
<h3><span class="header-section-number">1.8.6</span> Working directory</h3>
<p>Your <em>working directory</em> is the folder on your computer in which you are currently working. When you ask R to open a certain file, it will look in the working directory for this file, and when you tell R to save a data file or figure, it will save it in the working directory.</p>
<p>To set your working directory within RStudio you can go to <code>Tools / Set working directory</code>.</p>
</div>
<div id="loading-data" class="section level3">
<h3><span class="header-section-number">1.8.7</span> Loading Data</h3>
<p>The <code>read.table()</code> function is one of the primary ways to import a data set into <code>R</code>. The help file <code>?read.table()</code> contains details about how to use this function. We can use the function <code>write.table()</code> to export data.</p>
<p>Next we will show how to load the data set <a href="datasets/Auto.data"><code>Auto.data</code></a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Auto=<span class="kw">read.table</span>(<span class="st">&quot;Auto.data&quot;</span>,<span class="dt">header=</span>T,<span class="dt">na.strings =</span><span class="st">&quot;?&quot;</span>)
<span class="co"># For this file we needed to tell R that the first row is the</span>
<span class="co"># names of the variables.</span>
<span class="co"># na.strings tells R that any time it sees a particular character</span>
<span class="co"># or set of characters (such as a question mark), it should be</span>
<span class="co"># treated as a missing element of the data matrix. </span></code></pre></div>
<div class="rmdinsight">
<ul>
<li>
If the file is a csv format, we use <code>read.csv</code>.
</li>
<li>
Always try to look to the file before importing it to <code>R</code> (Open it in a text editor. See for example if the first row containes the variables names, if the columns are separated by <code>,</code> or <code>;</code> or ..
</li>
<li>
I suggest <a href="https://www.sublimetext.com/"><code>Sublime Text</code></a> or <a href="https://atom.io/"><code>Atom</code></a> as text editors.
</li>
</ul>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(Auto)
<span class="co">#ans&gt; [1] 397   9</span>
Auto[<span class="dv">1</span>:<span class="dv">4</span>,]
<span class="co">#ans&gt;   mpg cylinders displacement horsepower weight acceleration year origin</span>
<span class="co">#ans&gt; 1  18         8          307        130   3504         12.0   70      1</span>
<span class="co">#ans&gt; 2  15         8          350        165   3693         11.5   70      1</span>
<span class="co">#ans&gt; 3  18         8          318        150   3436         11.0   70      1</span>
<span class="co">#ans&gt; 4  16         8          304        150   3433         12.0   70      1</span>
<span class="co">#ans&gt;                        name</span>
<span class="co">#ans&gt; 1 chevrolet chevelle malibu</span>
<span class="co">#ans&gt; 2         buick skylark 320</span>
<span class="co">#ans&gt; 3        plymouth satellite</span>
<span class="co">#ans&gt; 4             amc rebel sst</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Once the data are loaded correctly, we can use names()</span>
<span class="co"># to check the variable names.</span>
<span class="kw">names</span>(Auto)
<span class="co">#ans&gt; [1] &quot;mpg&quot;          &quot;cylinders&quot;    &quot;displacement&quot; &quot;horsepower&quot;  </span>
<span class="co">#ans&gt; [5] &quot;weight&quot;       &quot;acceleration&quot; &quot;year&quot;         &quot;origin&quot;      </span>
<span class="co">#ans&gt; [9] &quot;name&quot;</span></code></pre></div>
<div class="rmdinsight">
<p>
This <a href="https://cran.r-project.org/doc/contrib/Torfs+Brauer-Short-R-Intro.pdf">(very) short introduction to R</a> can be useful.
</p>
</div>
</div>
</div>
<div id="regression" class="section level2">
<h2><span class="header-section-number">1.9</span> Regression</h2>
<div id="the-lm-function" class="section level3">
<h3><span class="header-section-number">1.9.1</span> The <code>lm</code> function</h3>
<p>We are going to employ the <code>EU</code> dataset. The <code>EU</code> dataset contains 28 rows with the member states of the European Union (Country), the number of seats assigned under different years (Seats2011, Seats2014), the Cambridge Compromise apportionment (CamCom2011), and the countries population (Population2010,Population2013).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># lm has the syntax: lm(formula = response ~ predictor, data = data)</span>
<span class="co"># The response is the y in the model. The predictor is x.</span>
<span class="co"># For example (after loading the EU dataset)</span>
mod &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> Seats2011 ~<span class="st"> </span>Population2010, <span class="dt">data =</span> EU)
<span class="co">#ans&gt; Error in eval(predvars, data, env): invalid &#39;envir&#39; argument of type &#39;character&#39;</span>

<span class="co"># We have saved the linear model into mod, which now contains all the output of lm</span>
<span class="co"># You can see it by typing</span>
mod
<span class="co">#ans&gt; Error in eval(expr, envir, enclos): object &#39;mod&#39; not found</span>

<span class="co"># mod is indeed a list of objects whose names are</span>
<span class="kw">names</span>(mod)
<span class="co">#ans&gt; Error in eval(expr, envir, enclos): object &#39;mod&#39; not found</span>

<span class="co"># We can access these elements by $</span>
<span class="co"># For example</span>
mod$coefficients
<span class="co">#ans&gt; Error in eval(expr, envir, enclos): object &#39;mod&#39; not found</span>

<span class="co"># The residuals</span>
mod$residuals
<span class="co">#ans&gt; Error in eval(expr, envir, enclos): object &#39;mod&#39; not found</span>

<span class="co"># The fitted values</span>
mod$fitted.values
<span class="co">#ans&gt; Error in eval(expr, envir, enclos): object &#39;mod&#39; not found</span>

<span class="co"># Summary of the model</span>
sumMod &lt;-<span class="st"> </span><span class="kw">summary</span>(mod)
<span class="co">#ans&gt; Error in summary(mod): object &#39;mod&#39; not found</span>
sumMod
<span class="co">#ans&gt; Error in eval(expr, envir, enclos): object &#39;sumMod&#39; not found</span></code></pre></div>
<p>The following table contains a handy cheat sheet of equivalences between <code>R</code> code and some of the statistical concepts associated to linear regression.</p>
<table style="width:100%;">
<colgroup>
<col width="51%" />
<col width="48%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"><code>R</code></th>
<th align="left">Statistical concept</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>x</code></td>
<td align="left">Predictor <span class="math inline">\(X_1,\ldots,X_n\)</span></td>
</tr>
<tr class="even">
<td align="left"><code>y</code></td>
<td align="left">Response <span class="math inline">\(Y_1,\ldots,Y_n\)</span></td>
</tr>
<tr class="odd">
<td align="left"><code>data &lt;- data.frame(x = x, y = y)</code></td>
<td align="left">Sample <span class="math inline">\((X_1,Y_1),\ldots,(X_n,Y_n)\)</span></td>
</tr>
<tr class="even">
<td align="left"><code>model &lt;- lm(y ~ x, data = data)</code></td>
<td align="left">Fitted linear model</td>
</tr>
<tr class="odd">
<td align="left"><code>model$coefficients</code></td>
<td align="left">Fitted coefficients <span class="math inline">\(\hat\beta_0,\hat\beta_1\)</span></td>
</tr>
<tr class="even">
<td align="left"><code>model$residuals</code></td>
<td align="left">Fitted residuals <span class="math inline">\(\hat\varepsilon_1,\ldots,\hat\varepsilon_n\)</span></td>
</tr>
<tr class="odd">
<td align="left"><code>model$fitted.values</code></td>
<td align="left">Fitted values <span class="math inline">\(\hat Y_1,\ldots,\hat Y_n\)</span></td>
</tr>
<tr class="even">
<td align="left"><code>model$df.residual</code></td>
<td align="left">Degrees of freedom <span class="math inline">\(n-2\)</span></td>
</tr>
<tr class="odd">
<td align="left"><code>summaryModel &lt;- summary(model)</code></td>
<td align="left">Summary of the fitted linear model</td>
</tr>
<tr class="even">
<td align="left"><code>summaryModel$sigma</code></td>
<td align="left">Fitted residual standard deviation <span class="math inline">\(\hat\sigma\)</span></td>
</tr>
<tr class="odd">
<td align="left"><code>summaryModel$r.squared</code></td>
<td align="left">Coefficient of determination <span class="math inline">\(R^2\)</span></td>
</tr>
<tr class="even">
<td align="left"><code>summaryModel$fstatistic</code></td>
<td align="left"><span class="math inline">\(F\)</span>-test</td>
</tr>
<tr class="odd">
<td align="left"><code>anova(model)</code></td>
<td align="left">ANOVA table</td>
</tr>
</tbody>
</table>
<div class="rmdexercise">
<p>
Do the following:
</p>
<ul>
<li>
Download The ‘EU’ dataset from <a href="datasets/EU.RData">here</a> as an <code>.RData</code> file and load it into use the function <code>load</code>.
</li>
<li>
Compute the regression of <code>CamCom2011</code> into <code>Population2010</code>. Save that model as the variable <code>myModel</code>.
</li>
<li>
Access the objects <code>residuals</code> and <code>coefficients</code> of <code>myModel</code>.
</li>
<li>
Compute the summary of <code>myModel</code> and store it as the variable <code>summaryMyModel</code>.
</li>
<li>
Access the object <code>sigma</code> of <code>myModel</code>.
</li>
</ul>
</div>
</div>
<div id="predicting-house-value-boston-dataset" class="section level3">
<h3><span class="header-section-number">1.9.2</span> Predicting House Value: Boston dataset</h3>
<p>We are going to use a dataset called Boston which is part of the <code>MASS</code> package. It recordes the median value of houses for 506 neighborhoods around Boston. Our task is to predict the median house value (<code>medv</code>) using only one predictor (<code>lstat</code>: percent of households with low socioeconomic status).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># First, install the MASS package using the command: install.packages(&quot;MASS&quot;)</span>

<span class="co"># load MASS package</span>
<span class="kw">library</span>(MASS)

<span class="co"># Check the dimensions of the Boston dataset</span>
<span class="kw">dim</span>(Boston)
<span class="co">#ans&gt; [1] 506  14</span></code></pre></div>
<p><strong>STEP 1: Split the dataset</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Split the data by using the first 400 observations as the training</span>
<span class="co"># data and the remaining as the testing data</span>
train =<span class="st"> </span><span class="dv">1</span>:<span class="dv">400</span>
test =<span class="st"> </span>-train

<span class="co"># Speficy that we are going to use only two variables (lstat and medv)</span>
variables =<span class="st"> </span><span class="kw">which</span>(<span class="kw">names</span>(Boston) ==<span class="kw">c</span>(<span class="st">&quot;lstat&quot;</span>, <span class="st">&quot;medv&quot;</span>))
training_data =<span class="st"> </span>Boston[train, variables]
testing_data =<span class="st"> </span>Boston[test, variables]

<span class="co"># Check the dimensions of the new dataset</span>
<span class="kw">dim</span>(training_data)
<span class="co">#ans&gt; [1] 400   2</span></code></pre></div>
<p><strong>STEP 2: Check for Linearity</strong></p>
<p>In order to perfom linear regression in <code>R</code>, we will use the function <code>lm()</code>to fit a simple linear regression with <code>medv</code> as the response (dependent variable) and <code>lstat</code> as the predictor or independent variable, and then save it in <code>model</code>.</p>
<p>But before we run our model, let’s visually check if the relationship between x and y is linear.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Scatterplot of lstat vs. medv</span>
<span class="kw">plot</span>(training_data$lstat, training_data$medv)</code></pre></div>
<p><img src="Machine-Learning_files/figure-html/unnamed-chunk-29-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>According to the plot, we see that the relationship is not linear. Let’s try a transformation of our explanatory variable <code>lstat</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Scatterplot of log(lstat) vs. medv</span>
<span class="kw">plot</span>(<span class="kw">log</span>(training_data$lstat), training_data$medv)</code></pre></div>
<p><img src="Machine-Learning_files/figure-html/unnamed-chunk-30-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Look at the plot, it is more linear, so we can proceed and perform <code>lm()</code>:</p>
<p><strong>STEP 3: Run the linear regression model</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model =<span class="st"> </span><span class="kw">lm</span>(medv ~<span class="st"> </span><span class="kw">log</span>(lstat), <span class="dt">data =</span> training_data)
model
<span class="co">#ans&gt; </span>
<span class="co">#ans&gt; Call:</span>
<span class="co">#ans&gt; lm(formula = medv ~ log(lstat), data = training_data)</span>
<span class="co">#ans&gt; </span>
<span class="co">#ans&gt; Coefficients:</span>
<span class="co">#ans&gt; (Intercept)   log(lstat)  </span>
<span class="co">#ans&gt;        51.8        -12.2</span></code></pre></div>
<p>Notice that basic information when we print <code>model</code>. This only give us the slope <span class="math inline">\((-12.2)\)</span> and the intercept <span class="math inline">\((51.8)\)</span> of the linear model. Note that here we are looking at <code>log(lstat)</code> and not <code>lstat</code> anymore. So for every one unit increase in <code>lstat</code>, the median value of the house will decrease by <span class="math inline">\(e^{12.2}\)</span>. For more detailed information, we can use the <code>summary()</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(model)
<span class="co">#ans&gt; </span>
<span class="co">#ans&gt; Call:</span>
<span class="co">#ans&gt; lm(formula = medv ~ log(lstat), data = training_data)</span>
<span class="co">#ans&gt; </span>
<span class="co">#ans&gt; Residuals:</span>
<span class="co">#ans&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#ans&gt; -11.385  -3.908  -0.779   2.245  25.728 </span>
<span class="co">#ans&gt; </span>
<span class="co">#ans&gt; Coefficients:</span>
<span class="co">#ans&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#ans&gt; (Intercept)   51.783      1.097    47.2   &lt;2e-16 ***</span>
<span class="co">#ans&gt; log(lstat)   -12.203      0.472   -25.9   &lt;2e-16 ***</span>
<span class="co">#ans&gt; ---</span>
<span class="co">#ans&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span>
<span class="co">#ans&gt; </span>
<span class="co">#ans&gt; Residual standard error: 5.6 on 398 degrees of freedom</span>
<span class="co">#ans&gt; Multiple R-squared:  0.627,   Adjusted R-squared:  0.626 </span>
<span class="co">#ans&gt; F-statistic:  669 on 1 and 398 DF,  p-value: &lt;2e-16</span></code></pre></div>
<p>Now, we have access to p-values and standard errors for the coefficients, as well as the <span class="math inline">\(R^2\)</span>.</p>
<ul>
<li>The output states that the slope is statistically significant and different from <span class="math inline">\(0\)</span> and with a t-value= <span class="math inline">\(-25.9\)</span> (p-value <span class="math inline">\(&lt; 0.05\)</span>), which means that there is a significant relationship between the percentage of households with low socioeconomic income and the median house value.</li>
<li>This relationship is negative. That is as the percantage of household with low socioeconomic income increases, the median house value decreases.</li>
<li>Looking at <span class="math inline">\(R^2\)</span>, we can deduce that <span class="math inline">\(62.7\%\)</span> of the model variation is being explained by the predictor <code>log(lstat)</code>. This is probably low, but indeed it would increase if we had more independent (explanatory) variables. We can use the <code>names()</code> function to see what other pieces of information are stored in our linear model (<code>model</code>).</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(model)
<span class="co">#ans&gt;  [1] &quot;coefficients&quot;  &quot;residuals&quot;     &quot;effects&quot;       &quot;rank&quot;         </span>
<span class="co">#ans&gt;  [5] &quot;fitted.values&quot; &quot;assign&quot;        &quot;qr&quot;            &quot;df.residual&quot;  </span>
<span class="co">#ans&gt;  [9] &quot;xlevels&quot;       &quot;call&quot;          &quot;terms&quot;         &quot;model&quot;</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model$coefficients
<span class="co">#ans&gt; (Intercept)  log(lstat) </span>
<span class="co">#ans&gt;        51.8       -12.2</span></code></pre></div>
<p>To obtain the confidence intervel for the linear model (<code>model</code>), we can use the <code>confint()</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">confint</span>(model, <span class="dt">level =</span> <span class="fl">0.95</span>)
<span class="co">#ans&gt;             2.5 % 97.5 %</span>
<span class="co">#ans&gt; (Intercept)  49.6   53.9</span>
<span class="co">#ans&gt; log(lstat)  -13.1  -11.3</span></code></pre></div>
<p>So, a <span class="math inline">\(95\%\)</span> confidence interval for the slope of <code>log(lstat)</code> is <span class="math inline">\((-13.13, -11.28)\)</span>. Notice that this confidence interval gives us the same result as the hypothesis test performed earlier, by stating that we are <span class="math inline">\(95\%\)</span> confident that the slope of <code>lstat</code> is not zero (in fact it is less than zero, which means that the relationship is negative.)</p>
<p><strong>STEP 4: Plot the regression model</strong></p>
<p>Now, let’s plot our regression line on top of our data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Scatterplot of lstat vs. medv</span>
<span class="kw">plot</span>(<span class="kw">log</span>(training_data$lstat), training_data$medv)

<span class="co"># Add the regression line to the existing scatterplot</span>
<span class="kw">abline</span>(model)</code></pre></div>
<p><img src="Machine-Learning_files/figure-html/unnamed-chunk-36-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Let’s play with the look of the plot, and makes it perttier!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Scatterplot of lstat vs. medv</span>
<span class="kw">plot</span>(<span class="kw">log</span>(training_data$lstat), training_data$medv,
<span class="dt">xlab =</span> <span class="st">&quot;Log Transform of % of Houshold with Low Socioeconomic Income&quot;</span>,
<span class="dt">ylab =</span> <span class="st">&quot;Median House Value&quot;</span>,
<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,
<span class="dt">pch =</span> <span class="dv">20</span>)

<span class="co"># Make the line color blue, and the line&#39;s width =3 (play with the width!)</span>
<span class="kw">abline</span>(model, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lwd =</span><span class="dv">3</span>)</code></pre></div>
<p><img src="Machine-Learning_files/figure-html/unnamed-chunk-37-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p><strong>STEP 5: Assess the model</strong></p>
<p>Final thing we will do is to predict using our fitted model. We can use the <code>predict()</code> function for this purpose:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Predict what is the median value of the house with lstat= 5%</span>
<span class="kw">predict</span>(model, <span class="kw">data.frame</span>(<span class="dt">lstat =</span> <span class="kw">c</span>(<span class="dv">5</span>)))
<span class="co">#ans&gt;    1 </span>
<span class="co">#ans&gt; 32.1</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Predict what is the median values of houses with lstat= 5%, 10%, and 15%</span>
<span class="kw">predict</span>(model, <span class="kw">data.frame</span>(<span class="dt">lstat =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>), <span class="dt">interval =</span> <span class="st">&quot;prediction&quot;</span>))
<span class="co">#ans&gt;    1    2    3 </span>
<span class="co">#ans&gt; 32.1 23.7 18.7</span></code></pre></div>
<p>Now let’s assess our model, by computing th mean squared error (MSE). To assess the model we created, then we will be using the test data!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Save the testing median values for houses (testing y) in y</span>
y =<span class="st"> </span>testing_data$medv

<span class="co"># Compute the predicted value for this y (y hat)</span>
y_hat =<span class="st"> </span><span class="kw">predict</span>(model, <span class="kw">data.frame</span>(<span class="dt">lstat =</span> testing_data$lstat))

<span class="co"># Now we have both y and y_hat for our testing data. </span>
<span class="co"># let&#39;s find the mean square error</span>
error =<span class="st"> </span>y-y_hat
error_squared =<span class="st"> </span>error^<span class="dv">2</span>
MSE =<span class="st"> </span><span class="kw">mean</span>(error_squared)
MSE
<span class="co">#ans&gt; [1] 17.7</span></code></pre></div>

</div>
</div>
</div>








            </section>

          </div>
        </div>
      </div>
<a href="linear-regression.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>


<script src="book_assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/lunr.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="book_assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["Machine-Learning.pdf"],
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
